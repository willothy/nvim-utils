# Example plugin

This contains the framework for a plugin. This is not the only way to package a plugin, just a way that I've found to be convenient.

Cargo exports `dylib` libraries as `lib<your-crate-name>.so` on Linux, `lib<your-crate-name>.dylib` on macOS, and `<your-crate-name>.dll` on Windows. The build script in this example generates a target-specific Makefile for renaming and copying the plugin and dependencies to the correct location in the `lua/` folder.

The main `Makefile` invokes Cargo to build the plugin, which outputs the built plugin and dependencies, as well as the autogenerated `Makefile.plugin`. The main Makefile then invokes the generated `Makefile.plugin` to copy the plugin and dependencies to the correct location in the `lua/` folder.

## Building

```sh
cd examples/example-plugin
make
```

After this, the plugin should be available in the `lua/` folder.

```python
lua/
├── example.so (or .dll or .dylib)
└── deps/
    ├── dep1.rlib
    ├── dep2.rlib
    └── ...
```

## Installing / Running

With Lazy.nvim

```lua
{
    dir = '~/path/to/example-plugin/', -- path to the plugin's root directory! not to lua/
    build = 'make',
}

```

With Packer.nvim

```lua
use {
    '~/path/to/example-plugin/',
    run = 'make',
}
```

Once the plugin is installed, you can require it like any other plugin:

```lua
require('example').hello()

-- to get the plugin info
print(vim.inspect(require('example').get_plugin_info()))

```
